<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>Jet Sim - Complete Box F15</title>
<style>
  body { margin:0; overflow:hidden; background:#87ceeb; }
  #hud{position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); font-size:32px; color:lime; font-family:monospace; pointer-events:none;}
</style>
</head>
<body>
<div id="hud">+</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ライト
scene.add(new THREE.AmbientLight(0xffffff,0.6));
const dirLight = new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(5,10,5);
scene.add(dirLight);

// ===== 戦闘機（完全箱F-15） =====
const jet = new THREE.Group();

// 胴体
const body = new THREE.Mesh(
  new THREE.BoxGeometry(1,0.4,3),
  new THREE.MeshStandardMaterial({color:0x777777})
);
jet.add(body);

// 主翼
const wing = new THREE.Mesh(
  new THREE.BoxGeometry(3,0.05,1),
  new THREE.MeshStandardMaterial({color:0x666666})
);
wing.position.y = -0.1;
jet.add(wing);

// 垂直尾翼 左
const tailL = new THREE.Mesh(
  new THREE.BoxGeometry(0.2,0.6,0.5),
  new THREE.MeshStandardMaterial({color:0x555555})
);
tailL.position.set(-0.35,0.3,-1.2);
jet.add(tailL);

// 垂直尾翼 右
const tailR = tailL.clone();
tailR.position.x = 0.35;
jet.add(tailR);

// コックピット（透明）
const cockpit = new THREE.Mesh(
  new THREE.CylinderGeometry(0.25,0.25,0.8,16),
  new THREE.MeshStandardMaterial({color:0x5555ff, transparent:true, opacity:0.5})
);
cockpit.rotation.z = Math.PI/2;
cockpit.position.set(0,0.2,0.5);
jet.add(cockpit);

// エンジン 左
const engineL = new THREE.Mesh(
  new THREE.CylinderGeometry(0.18,0.22,0.8,12),
  new THREE.MeshStandardMaterial({color:0x333333})
);
engineL.rotation.x = Math.PI/2;
engineL.position.set(-0.35,-0.05,-1.8);
jet.add(engineL);

// エンジン 右
const engineR = engineL.clone();
engineR.position.x = 0.35;
jet.add(engineR);

scene.add(jet);

// ===== 地面 =====
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(1000,1000),
  new THREE.MeshStandardMaterial({color:0x2e8b57})
);
ground.rotation.x = -Math.PI/2;
ground.position.y = -3;
scene.add(ground);

// ===== 山（スクロール） =====
const mountains = [];
for(let i=0;i<30;i++){
  const m = new THREE.Mesh(
    new THREE.ConeGeometry(5,10,6),
    new THREE.MeshStandardMaterial({color:0x556b2f})
  );
  m.position.set((Math.random()-0.5)*100, -3, -i*40);
  scene.add(m);
  mountains.push(m);
}

// ===== 弾 =====
const bullets = [];
function shoot(){
  const b = new THREE.Mesh(
    new THREE.SphereGeometry(0.12,8,8),
    new THREE.MeshBasicMaterial({color:0xff3333})
  );
  b.position.copy(jet.position);
  scene.add(b);
  bullets.push(b);
}

// ===== キー入力 =====
const keys = {};
window.addEventListener("keydown", e=>{keys[e.key]=true;if(e.key===" ")shoot();});
window.addEventListener("keyup", e=>keys[e.key]=false);

// ===== 変数 =====
let baseSpeed = 0.25;
let boostSpeed = 0.55;
let rollTarget = 0;

// ===== アニメーション =====
function animate(){
  requestAnimationFrame(animate);

  // スピード
  const speed = keys["Shift"] ? boostSpeed : baseSpeed;
  jet.position.z -= speed;

  // WASD操作
  if(keys["a"]){jet.position.x-=0.08; rollTarget=0.35;}
  if(keys["d"]){jet.position.x+=0.08; rollTarget=-0.35;}
  if(keys["w"]) jet.position.y+=0.06;
  if(keys["s"]) jet.position.y-=0.06;

  // バンク
  jet.rotation.z += (rollTarget - jet.rotation.z)*0.1;
  rollTarget *= 0.9;

  // ピッチ（上下で鼻上げ）
  if(keys["w"]) jet.rotation.x = Math.max(jet.rotation.x - 0.02, -0.4);
  if(keys["s"]) jet.rotation.x = Math.min(jet.rotation.x + 0.02, 0.4);
  jet.rotation.x *= 0.95;

  // ふわっと揺れ
  jet.position.y += Math.sin(Date.now()*0.002)*0.01;

  // 弾を前に進める
  bullets.forEach(b=>b.position.z-=1.2);

  // 山スクロール
  mountains.forEach(m=>{
    m.position.z += speed;
    if(m.position.z > jet.position.z + 10){
      m.position.z -= 1200;
      m.position.x = (Math.random()-0.5)*100;
    }
  });

  // カメラ追従
  const camTarget = new THREE.Vector3(jet.position.x, jet.position.y+1.2, jet.position.z+9);
  camera.position.lerp(camTarget,0.1);
  camera.lookAt(jet.position);

  renderer.render(scene,camera);
}

animate();

// リサイズ対応
window.addEventListener("resize", ()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

</script>
</body>
</html>


