<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>F-15 Almost Real</title>
<style>
body{margin:0;overflow:hidden;background:#87ceeb;}
</style>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
const scene=new THREE.Scene();
scene.background=new THREE.Color(0x87ceeb);

const camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,0.1,5000);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.6));
const sun=new THREE.DirectionalLight(0xffffff,0.9);
sun.position.set(10,20,10);
scene.add(sun);

/* ===== 機体 ===== */
const jet=new THREE.Group();
scene.add(jet);

/* 胴体（流線型） */
const profile=[
  new THREE.Vector2(0.05,0),
  new THREE.Vector2(0.25,2),
  new THREE.Vector2(0.45,6),
  new THREE.Vector2(0.65,12),
  new THREE.Vector2(0.75,18),
  new THREE.Vector2(0.7,22),
  new THREE.Vector2(0.6,26)
];
const body=new THREE.Mesh(
  new THREE.LatheGeometry(profile,40),
  new THREE.MeshStandardMaterial({color:0x777777})
);
body.rotation.x=Math.PI/2;
jet.add(body);

/* コックピット */
const canopy=new THREE.Mesh(
  new THREE.CylinderGeometry(0.25,0.35,2.2,16),
  new THREE.MeshStandardMaterial({color:0x99ccff,transparent:true,opacity:0.6})
);
canopy.rotation.x=Math.PI/2;
canopy.position.set(0,0.7,6);
jet.add(canopy);

/* 主翼（F-15らしい後退角） */
function mainWing(side){
  const s=new THREE.Shape();
  s.moveTo(0,0);
  s.lineTo(7*side,-1);
  s.lineTo(3*side,-5);
  s.lineTo(0,-4);
  s.lineTo(0,0);

  const w=new THREE.Mesh(
    new THREE.ShapeGeometry(s),
    new THREE.MeshStandardMaterial({color:0x666666})
  );
  w.rotation.x=-Math.PI/2;
  w.rotation.z=side*0.08;   // 上反角
  w.position.z=10;
  return w;
}
jet.add(mainWing(1));
jet.add(mainWing(-1));

/* 水平尾翼 */
function tailWing(side){
  const s=new THREE.Shape();
  s.moveTo(0,0);
  s.lineTo(3.5*side,-0.5);
  s.lineTo(1.5*side,-2.5);
  s.lineTo(0,-2);
  s.lineTo(0,0);

  const t=new THREE.Mesh(
    new THREE.ShapeGeometry(s),
    new THREE.MeshStandardMaterial({color:0x666666})
  );
  t.rotation.x=-Math.PI/2;
  t.position.z=20;
  return t;
}
jet.add(tailWing(1));
jet.add(tailWing(-1));

/* 双垂直尾翼（超重要） */
function fin(x,rot){
  const f=new THREE.Mesh(
    new THREE.PlaneGeometry(2.5,4),
    new THREE.MeshStandardMaterial({color:0x666666})
  );
  f.position.set(x,2,21);
  f.rotation.y=rot;
  return f;
}
jet.add(fin(0.9,Math.PI-0.2));
jet.add(fin(-0.9,Math.PI+0.2));

/* 地面 */
const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(8000,8000),
  new THREE.MeshStandardMaterial({color:0x2e8b57})
);
ground.rotation.x=-Math.PI/2;
ground.position.y=-4;
scene.add(ground);

/* カメラ追従 */
function camFollow(){
  const offset=new THREE.Vector3(0,4,-16);
  offset.applyQuaternion(jet.quaternion);
  camera.position.copy(jet.position).add(offset);
  camera.lookAt(jet.position);
}

/* アニメ */
function animate(){
  requestAnimationFrame(animate);
  jet.position.z+=0.6;
  camFollow();
  renderer.render(scene,camera);
}
animate();

addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
