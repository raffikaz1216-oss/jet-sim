<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>F-15 Proper Shape</title>
<style>
  body { margin:0; overflow:hidden; background:#87ceeb; }
</style>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
/* ===== 基本 ===== */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 5000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const sun = new THREE.DirectionalLight(0xffffff, 0.9);
sun.position.set(5,10,5);
scene.add(sun);

/* ===== F-15 機体 ===== */
const jet = new THREE.Group();
scene.add(jet);

/* === 胴体（回転体・これが本命） === */
const profile = [
  new THREE.Vector2(0.05, 0),   // 機首
  new THREE.Vector2(0.25, 1),
  new THREE.Vector2(0.45, 3),
  new THREE.Vector2(0.55, 6),
  new THREE.Vector2(0.65, 9),
  new THREE.Vector2(0.75, 12), // 胴体最大
  new THREE.Vector2(0.7, 15),
  new THREE.Vector2(0.6, 18)   // エンジン前
];

const body = new THREE.Mesh(
  new THREE.LatheGeometry(profile, 32),
  new THREE.MeshStandardMaterial({ color:0x777777 })
);
body.rotation.x = Math.PI/2;
jet.add(body);

/* === 主翼（F-15比率） === */
function mainWing(side){
  const shape = new THREE.Shape();
  shape.moveTo(0,0);
  shape.lineTo(6*side, -0.5);
  shape.lineTo(2*side, -4);
  shape.lineTo(0,-3);
  shape.lineTo(0,0);

  const wing = new THREE.Mesh(
    new THREE.ShapeGeometry(shape),
    new THREE.MeshStandardMaterial({ color:0x666666 })
  );
  wing.rotation.x = -Math.PI/2;
  wing.position.set(0,0,7);
  return wing;
}
jet.add(mainWing(1));
jet.add(mainWing(-1));

/* === 水平尾翼 === */
function tailWing(side){
  const shape = new THREE.Shape();
  shape.moveTo(0,0);
  shape.lineTo(3*side,-0.3);
  shape.lineTo(1.2*side,-2);
  shape.lineTo(0,-1.8);
  shape.lineTo(0,0);

  const t = new THREE.Mesh(
    new THREE.ShapeGeometry(shape),
    new THREE.MeshStandardMaterial({ color:0x666666 })
  );
  t.rotation.x = -Math.PI/2;
  t.position.set(0,0,15.5);
  return t;
}
jet.add(tailWing(1));
jet.add(tailWing(-1));

/* === 垂直尾翼（2枚） === */
function fin(x){
  const f = new THREE.Mesh(
    new THREE.PlaneGeometry(2,3),
    new THREE.MeshStandardMaterial({ color:0x666666 })
  );
  f.position.set(x,1.5,15);
  f.rotation.y = Math.PI;
  return f;
}
jet.add(fin(0.6));
jet.add(fin(-0.6));

/* === コックピット === */
const canopy = new THREE.Mesh(
  new THREE.CylinderGeometry(0.25,0.35,2,16),
  new THREE.MeshStandardMaterial({
    color:0x99ccff, transparent:true, opacity:0.6
  })
);
canopy.rotation.x = Math.PI/2;
canopy.position.set(0,0.6,4);
jet.add(canopy);

/* ===== 地面 ===== */
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(5000,5000),
  new THREE.MeshStandardMaterial({ color:0x2e8b57 })
);
ground.rotation.x = -Math.PI/2;
ground.position.y = -3;
scene.add(ground);

/* ===== カメラ（後方追従） ===== */
function updateCamera(){
  const offset = new THREE.Vector3(0,3,-12);
  offset.applyQuaternion(jet.quaternion);
  camera.position.copy(jet.position).add(offset);
  camera.lookAt(jet.position);
}

/* ===== アニメーション ===== */
function animate(){
  requestAnimationFrame(animate);
  jet.position.z += 0.4;
  updateCamera();
  renderer.render(scene, camera);
}
animate();

addEventListener('resize',()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>
</body>
</html>

